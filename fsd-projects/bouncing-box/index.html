<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Bouncing Box</title>
    <script src="jquery.min.js"></script>
    <style>
      .box {
        width: 70px;
        height: 70px;
        background-color: teal;
        font-size: 300%;
        text-align: center;
        user-select: none;
        display: block;
        position: absolute;
        top: 100px;
        left: 0px;
      }

      .board {
        height: 100vh;
        background-image: url("https://www.bing.com/th/id/OIP.1gm9ZgMMKWXwKNYw0GP36gHaEK?w=245&h=211&c=8&rs=1&qlt=90&o=6&cb=12&dpr=1.3&pid=3.1&rm=2");
        background-position: center;
        background-size: cover;
      }

      .Game-over {
        font-size: 40px;
        color: red;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: none;
      }

      .misclick-counter {
        position: absolute;
        top: 10px;
        left: 10px;
        font-size: 24px;
        color: white;
      }
    </style>
  </head>

  <body class="board">

    <div class="box">?</div>
    <div class="misclick-counter">misses: 0</div>
    <div class="Game-over">Divine's Bouncing Box - GAME OVER</div>

    <script>
      (function () {
        "use strict";

        var gameOverMessage = jQuery(".Game-over");
        var missCounterDisplay = jQuery(".misclick-counter");
        
        var box = jQuery(".box");
        var board = jQuery(".board");

        var boardWidth = board.width();
        var boardHeight = jQuery(window).height();

        jQuery(window).on("resize", function () {
          boardWidth = board.width();
        });

        // GAME VARIABLES
        var positionX = 0;
        var positionY = 0;
        var speed = 5;
        var speedY = 3;
        var points = 0;
        var misses = 0;
        var maxMisses = 5;
        var gameActive = true;

        var interval = setInterval(update, 50);

        // BOARD CLICK = MISCLICK (increase miss count)
        board.on("click", function () {
          if (!gameActive) return;
          misses++;
          missCounterDisplay.text("misses: " + misses);

          if (misses >= maxMisses) {
            endGame();
          }
        });

        // BOX CLICK â€” do NOT count as miss
        box.on("click", function (event) {
          event.stopPropagation();
          handleBoxClick(event);
        });

        function moveBoxTo(newPositionX, newPositionY) {
          box.css("left", newPositionX);
          box.css("top", newPositionY);
        }

        function changeBoxText(newText) {
          box.text(newText);
        }

        // REAL GAME OVER FUNCTION
        function endGame() {
          gameActive = false;
          clearInterval(interval);
          box.hide();
          gameOverMessage.show();
        }

        function update() {
          if (!gameActive) return;

          positionX += speed;
          positionY += speedY;

          moveBoxTo(positionX, positionY);

          if (positionX < 0 || positionX > boardWidth - box.width()) {
            speed = -speed;
          }

          if (positionY < 0 || positionY > boardHeight - box.height()) {
            speedY = -speedY;
          }
        }

        function handleBoxClick() {
          if (!gameActive) return;

          points++;
          speed += 3;

          positionX = 0;
          changeBoxText(points);

          if (points % 3 === 0) {
            box.css("background-color", getRandomColor());
          }
        }

        function getRandomColor() {
          var r = Math.floor(Math.random() * 255);
          var g = Math.floor(Math.random() * 255);
          var b = Math.floor(Math.random() * 255);
          return "rgb(" + r + "," + g + "," + b + ")";
        }
      })();
    </script>
  </body>
</html>
